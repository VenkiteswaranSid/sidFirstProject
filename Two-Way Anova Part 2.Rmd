---
title: "Two-Way Anova Part 2"
author: "Siddharth V"
date: '2022-04-20'
output: html_document
---

```{r}
library(tidyverse)
library(kableExtra)
```

## Loading in the data
```{r}
## Creating a url for Jordan's career
mj_url <- read_html('https://www.basketball-reference.com/leagues/NBA_1991_per_game.html')

## Turning that information into a list
mj_info_lst = mj_url %>%
  html_nodes('#per_game_stats') %>%
  html_table()

## Creating a temporary data frame to hold the information from the list
temp_mj_df = mj_info_lst[[1]]

## Filtering out the season where he first won the championship and making that the lj data frame
mj_df_without_name = temp_mj_df %>%
  filter(Rk != 'Rk') %>%
  mutate_if(~any(str_detect(string = ., pattern = '^-?[0-9]\\d*(\\.\\d+)?$')),
            ~ as.numeric(.)) %>%
  distinct(Player,max(G),.keep_all = TRUE)

## Fixing column names
colnames(mj_df_without_name)[c(11,14,17,18,21)] = c('FG_percent', '3P_percent', '2P_percent', 'eFG_percent', 'FT_percent')

## Adding a column with the data frame name
mj_df = mj_df_without_name %>%
  mutate(df_name = 'MJ')

## Adding a new variable called binary_mp
mod1_mj_df = mj_df %>%
  mutate(Pos = as.factor(Pos),
    binary_mp = case_when(
    MP < 20 ~ 'few_mp',
    MP >= 20 ~ 'large_mp'
  ))

mod2_mj_df = subset(mod1_mj_df, Pos != 'SG-SF')
mod3_mj_df = subset(mod2_mj_df, Pos != 'SF-SG')
```

## General Approach
Remember the purpose of Two-Way ANOVA is to test for three different effects on the response variable:
1. Explanatory Variable 1
2. Explanatory Variable 2
3. The Interaction between both explanatory variables

## Summary of 1 of the Explanatory Variables: Position
```{r}
mod3_mj_df %>%
group_by(Pos) %>%
summarise(`Sample Mean Pos` = mean(PTS, na.rm = TRUE),
`Sample SD Pos` = sd(PTS, na.rm = TRUE),
`Sample Size Pos` = n()) %>%

kable() %>%
kable_styling() %>%
footnote('Pos denotes the Number of Positions')
```

## Interpretation
The basic interpretation of this summary was done within One-Way ANOVA in that the sample mean of points is lowest in for the center position and highest for the small forward position.
It is important to note that SF has the highest sd and mean, while C has the lowest sd and mean. This suggests that there is a high level of variance at the SF position and a low level of variance in the C position.
The sample size is not equal across the number of positions.

## Summary of 1 of the Explanatory Variables: Minutes Played
```{r}
mod3_mj_df %>%
group_by(binary_mp) %>%
summarise(`Sample Mean MP` = mean(PTS, na.rm = TRUE),
`Sample SD MP` = sd(PTS, na.rm = TRUE),
`Sample Size MP` = n()) %>%

kable() %>%
kable_styling() %>%
footnote('MP denotes the Amount of Minutes Played')
```

